/* MPC Slide System */
/* Enforces strict alignment, safety areas, and visual hierarchy */

:root {
    --mpc-safety-area: 3%;
}

/* Base Slide Container (Scrollable Preview Mode) */
.mpc-slide {
    position: relative;
    width: 100%;
    /* Keep 16:9 Aspect Ratio */
    aspect-ratio: 16 / 9;
    background-color: var(--mpc-color-base, #ffffff);
    color: var(--mpc-color-text, #000000);
    overflow: hidden;
    margin-bottom: 2em;
    box-shadow: 0 4em 1.2em rgba(0, 0, 0, 0.1);
    box-sizing: border-box;
    display: flex;
    flex-direction: column;

    /* Responsive Typography System */
    container-type: inline-size;
    /* Base font size scales with container width (approx 16px at 1000px width) */
    font-size: 1.6cqw;
}

/* Safety Area Inner Container */
.mpc-slide-inner {
    padding: 3%;
    width: 100%;
    height: 100%;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    /* Ensure content stays inside safety area */
}

/* Global Reset for Slide Content */
.mpc-slide-inner * {
    box-sizing: border-box;
    max-width: 100%;
}

.mpc-slide-inner canvas {
    max-width: 100% !important;
    max-height: 100% !important;
}

/* Prevent margins from breaking layout in strict flex/grid */
.mpc-slide-container {
    margin: 0 !important;
    width: 100% !important;
    height: 100% !important;
}


/* すべてのスライドの共通土台 */
.mpc-slide .slide-base {
    display: flex;
    flex-direction: column;
    padding: 3%;
    /* セーフティエリア */
    height: 100%;
    box-sizing: border-box;
    background-color: var(--mpc-color-main, #1A365D);
    color: var(--mpc-color-base, #ffffff);
    overflow: hidden;
}


/* 1. Title Slide Master */
.mpc-slide .slide-title {
    /* slide-base と併用することを前提に、中央寄せの設定を追加 */
    justify-content: center;
    /* 縦方向中央 */
    align-items: center;
    /* 横方向中央 */
    text-align: center;
    /* テキスト中央揃え */
}

.mpc-slide .slide-title h1 {
    font-size: clamp(3rem, 6vw, 10rem);
    margin: 0;
    padding: 0;
    border: none;
    /* 標準スライドの下線が必要なければ消す */
    flex: 0 0 auto;
}

.mpc-slide .slide-title h2 {
    font-size: clamp(2rem, 4vw, 6rem);
    margin: 0;
    padding: 0;
    border: none;
    /* 標準スライドの下線が必要なければ消す */
    flex: 0 0 auto;
}

/* 2. Section Title Master */
.mpc-slide .slide-section {
    /* slide-base と併用することを前提に、中央寄せの設定を追加 */
    justify-content: center;
    /* 縦方向中央 */
    align-items: center;
    /* 横方向中央 */
    text-align: left;
    /* テキスト中央揃え */
}

.mpc-slide .slide-section h2 {
    font-size: clamp(2rem, 4vw, 6rem);
    position: relative;
    color: inherit !important;
    background: none !important;
    border: none !important;
}

.mpc-slide .slide-section h2::after {
    content: '';
    position: absolute;
    bottom: -0.3em;
    left: 0;
    width: 15%;
    height: 0.12em;
    background-color: var(--mpc-color-accent, #F6AD55);
}

/* 3. Standard Slide (Key Message + Visual) */
.mpc-slide .slide-standard {
    /* 共通土台を継承（またはクラスを2つ書く） */
    justify-content: flex-start;
    /* 上詰め */
    gap: 20px;
    /* ヘッダーとコンテンツの間の隙間 */
}

.mpc-slide .slide-standard h1:first-child,
.mpc-slide .slide-standard h2:first-child {
    margin: 0;
    padding-bottom: 0.5em;
    border-bottom: 3px solid #ffd700;
    width: 100%;
    flex-shrink: 0;
    /* ヘッダーが潰れないように固定 */
    font-size: clamp(0.5rem, 4vw, 10rem);
}

/* --- コンテンツ（それ以外の要素すべて） --- */
/* 見出し以外のすべての直下要素を2行目以降に流す */
.mpc-slide .slide-standard>*:not(h1):not(h2):not(ul):not(li) {
    flex: 0 1 auto;
    height: auto;
    margin: 0;
    padding: 10px 0;
    /* 詰まりすぎないように上下余白をつける */
    font-size: clamp(0.5rem, 2vw, 10rem);
}



.mpc-slide .slide-standard ul li {
    flex: 0 1 auto;
    height: auto;
    margin: 0;
    /* padding: 10px 0; */
    /* 詰まりすぎないように上下余白をつける */
    font-size: clamp(0.5rem, 2vw, 10rem);
}

/* 4. 2-Column Slide */
/* Use Standard Flex Column for main layout */
.mpc-slide .slide-2col {
    display: flex !important;
    flex-direction: row;
    /* 基本は横並び */
    flex-wrap: wrap;
    /* 幅がいっぱいになったら改行する */
    align-content: flex-start;
    /* 全体を上詰めに寄せる */

    height: 100%;
    box-sizing: border-box;
    gap: 0px 40px;
    /* 縦の隙間 20px / 横の隙間 40px */
    background-color: var(--mpc-color-main, #1A365D);
    color: var(--mpc-color-base, #ffffff);
}

/* Header spans full width in grid */
.mpc-slide .slide-2col h1:first-child,
.mpc-slide .slide-2col h2:first-child {
    width: 100%;
    /* 横幅100%占領（これで後続が2段目に落ちる） */
    flex: 0 0 auto;
    /* 勝手に伸び縮みさせない */
    margin: 0 0 20px 0;
    /* 下のコンテンツとの距離 */
    padding-bottom: 0.5em;
    border-bottom: 3px solid #ffd700;
    font-size: clamp(0.5rem, 4vw, 10rem);
}

/* Ensure the JS-generated wrapper fills the remaining space */
.mpc-slide .slide-2col .mpc-column {
    flex: 1;
    /* 1:1 で残りの横幅を分け合う */
    min-width: 0;
    /* 文字がはみ出した時にカラムを突き破らないようにする */

    /* カラム内の要素（h3やul）を整える */
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    font-size: clamp(0.5rem, 2vw, 10rem);
}

/* 5. Summary Slide */
.mpc-slide .slide-summary {
    justify-content: flex-start;
    /* 上から順に並べる */
    align-items: center;
    /* 横方向は中央に寄せる */
}

/* まとめ見出し */
.mpc-slide .slide-summary h1,
.mpc-slide .slide-summary h2 {
    width: 100%;
    text-align: center;
    /* タイトルは中央 */
    margin: 0 0 40px 0;
    padding-bottom: 15px;
    border-bottom: 3px solid #ffd700;
    flex: 0 0 auto;
    font-size: clamp(2rem, 4vw, 6rem);

}

/* まとめリストを包む箱 (.mpc-column) */
.mpc-slide .slide-summary .mpc-column {
    width: 80%;
    /* 少し幅を絞ると読みやすい */
    background: rgba(255, 255, 255, 0.05);
    /* ほんのり背景を敷く */
    padding: 40px;
    border-radius: 15px;
    border-left: 10px solid #ffd700;
    /* アクセントの左線 */
    flex: 0 1 auto;
    /* 中身に応じて高さを決める（伸びすぎ防止） */
}

/* リスト自体の装飾 */
.mpc-slide .slide-summary ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.mpc-slide .slide-summary li {
    font-size: clamp(1.5rem, 3vw, 2.5rem);
    margin-bottom: 0.5rem;
    line-height: 1.4;
}

.mpc-slide .slide-summary li:last-child {
    margin-bottom: 0;
}

.mpc-slide .slide-base a {
    color: var(--mpc-color-accent, #ffd700);
    /* 見出しの線と同じ黄色 */
    text-decoration: underline;
    /* リンクであることを明示 */
    font-weight: bold;
    transition: opacity 0.2s;
    /* ホバー時の動きを滑らかに */
}

/* ホバー（マウスを乗せた時）の設定 */
.mpc-slide .slide-base a:hover {
    opacity: 0.7;
    color: #ffffff;
    /* ホバーで白く光らせる */
}

/* 訪問済みのリンクが紫色にならないように固定 */
.mpc-slide .slide-base a:visited {
    color: var(--mpc-color-accent, #ffd700);
}

/* Universal Visual Components */
.mpc-slide img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    border-radius: 4px;
}

/* Background Image Feature */
.mpc-slide.has-bg {
    background-size: cover;
    background-position: center;
}

.mpc-slide.has-bg .mpc-slide-inner {
    background-color: rgba(255, 255, 255, 0.7);
    /* Optional overlay to keep text readable */
}

/* Speaker Note - Hidden by default */
.mpc-note {
    display: none;
}

/* --- Graph Container Constraints in Slides --- */
/* Ensure graphs take available space but do not overflow */
.mpc-slide-inner [class*="graph-"] {
    flex: 1;
    min-height: 50px;
    /* Kept as requested by user */
    /* Crucial for flex/grid overflow */
    width: 100%;
    height: 100%;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

/* Ensure canvas respects the container limits */
.mpc-slide-inner [class*="graph-"] canvas {
    max-width: 100%;
    max-height: 100%;
}



/* --- Chart Container --- */
/* Chart.js requires a relative parent with defined height to size correctly */
.mpc-chart-container {
    position: relative;
    width: 100%;
    /* Default height - User can override this in their themes */
    height: 400px;
}